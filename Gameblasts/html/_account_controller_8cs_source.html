<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Gameblasts: Controllers/AccountController.cs Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Gameblasts
   </div>
   <div id="projectbrief">DAT219 University Project</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('_account_controller_8cs_source.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">AccountController.cs</div>  </div>
</div><!--header-->
<div class="contents">
<a href="_account_controller_8cs.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="keyword">using</span> <a class="code" href="namespace_system.html">System</a>.Linq;</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="keyword">using</span> <a class="code" href="namespace_system.html">System</a>.Security.Claims;</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="keyword">using</span> <a class="code" href="namespace_system.html">System</a>.Threading.Tasks;</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="keyword">using</span> Microsoft.AspNetCore.Authorization;</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="keyword">using</span> Microsoft.AspNetCore.Identity;</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="keyword">using</span> Microsoft.AspNetCore.Mvc;</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="keyword">using</span> Microsoft.AspNetCore.Mvc.Rendering;</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="keyword">using</span> Microsoft.Extensions.Logging;</div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="keyword">using</span> Microsoft.Extensions.Options;</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="keyword">using</span> <a class="code" href="namespace_gameblasts.html">Gameblasts</a>.<a class="code" href="namespace_gameblasts_1_1_models.html">Models</a>;</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="keyword">using</span> <a class="code" href="namespace_gameblasts.html">Gameblasts</a>.<a class="code" href="namespace_gameblasts_1_1_models.html">Models</a>.<a class="code" href="namespace_gameblasts_1_1_models_1_1_account_view_models.html">AccountViewModels</a>;</div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="keyword">using</span> <a class="code" href="namespace_gameblasts.html">Gameblasts</a>.<a class="code" href="namespace_gameblasts_1_1_services.html">Services</a>;</div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;</div><div class="line"><a name="l00014"></a><span class="lineno"><a class="line" href="namespace_gameblasts_1_1_controllers.html">   14</a></span>&#160;<span class="keyword">namespace </span><a class="code" href="namespace_gameblasts.html">Gameblasts</a>.Controllers</div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;{</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;    [Authorize]</div><div class="line"><a name="l00017"></a><span class="lineno"><a class="line" href="class_gameblasts_1_1_controllers_1_1_account_controller.html">   17</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">class </span><a class="code" href="class_gameblasts_1_1_controllers_1_1_account_controller.html">AccountController</a> : Controller</div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;    {</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;        <span class="keyword">private</span> readonly UserManager&lt;ApplicationUser&gt; _userManager;</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;        <span class="keyword">private</span> readonly SignInManager&lt;ApplicationUser&gt; _signInManager;</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;        <span class="keyword">private</span> readonly <a class="code" href="interface_gameblasts_1_1_services_1_1_i_email_sender.html">IEmailSender</a> _emailSender;</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;        <span class="keyword">private</span> readonly <a class="code" href="interface_gameblasts_1_1_services_1_1_i_sms_sender.html">ISmsSender</a> _smsSender;</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;        <span class="keyword">private</span> readonly ILogger _logger;</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;        <span class="keyword">private</span> readonly <span class="keywordtype">string</span> _externalCookieScheme;</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;</div><div class="line"><a name="l00026"></a><span class="lineno"><a class="line" href="class_gameblasts_1_1_controllers_1_1_account_controller.html#ae98fb9f4e88ef8c55fe61d45324d7098">   26</a></span>&#160;        <span class="keyword">public</span> <a class="code" href="class_gameblasts_1_1_controllers_1_1_account_controller.html#ae98fb9f4e88ef8c55fe61d45324d7098">AccountController</a>(</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;            UserManager&lt;ApplicationUser&gt; userManager,</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;            SignInManager&lt;ApplicationUser&gt; signInManager,</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;            IOptions&lt;IdentityCookieOptions&gt; identityCookieOptions,</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;            <a class="code" href="interface_gameblasts_1_1_services_1_1_i_email_sender.html">IEmailSender</a> emailSender,</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;            <a class="code" href="interface_gameblasts_1_1_services_1_1_i_sms_sender.html">ISmsSender</a> smsSender,</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;            ILoggerFactory loggerFactory)</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;        {</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;            _userManager = userManager;</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;            _signInManager = signInManager;</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;            _externalCookieScheme = identityCookieOptions.Value.ExternalCookieAuthenticationScheme;</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;            _emailSender = emailSender;</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;            _smsSender = smsSender;</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;            _logger = loggerFactory.CreateLogger&lt;<a class="code" href="class_gameblasts_1_1_controllers_1_1_account_controller.html">AccountController</a>&gt;();</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;        }</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;        <span class="comment">//</span></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;        <span class="comment">// GET: /Account/Login</span></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;        [HttpGet]</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;        [AllowAnonymous]</div><div class="line"><a name="l00046"></a><span class="lineno"><a class="line" href="class_gameblasts_1_1_controllers_1_1_account_controller.html#a258df15230ca9ae910243f8afe6068ff">   46</a></span>&#160;        <span class="keyword">public</span> async Task&lt;IActionResult&gt; <a class="code" href="class_gameblasts_1_1_controllers_1_1_account_controller.html#a258df15230ca9ae910243f8afe6068ff">Login</a>(<span class="keywordtype">string</span> returnUrl = null)</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;        {</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;            <span class="comment">// Clear the existing external cookie to ensure a clean login process</span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;            await HttpContext.Authentication.SignOutAsync(_externalCookieScheme);</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;            ViewData[<span class="stringliteral">&quot;ReturnUrl&quot;</span>] = returnUrl;</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;            <span class="keywordflow">return</span> View();</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;        }</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;        <span class="comment">//</span></div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;        <span class="comment">// POST: /Account/Login</span></div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;        [HttpPost]</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;        [AllowAnonymous]</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;        [ValidateAntiForgeryToken]</div><div class="line"><a name="l00060"></a><span class="lineno"><a class="line" href="class_gameblasts_1_1_controllers_1_1_account_controller.html#add1cc307820abd3a07bae2cba5f197c0">   60</a></span>&#160;        <span class="keyword">public</span> async Task&lt;IActionResult&gt; <a class="code" href="class_gameblasts_1_1_controllers_1_1_account_controller.html#add1cc307820abd3a07bae2cba5f197c0">Login</a>(<a class="code" href="class_gameblasts_1_1_models_1_1_account_view_models_1_1_login_view_model.html">LoginViewModel</a> model, <span class="keywordtype">string</span> returnUrl = null)</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;        {</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;            ViewData[<span class="stringliteral">&quot;ReturnUrl&quot;</span>] = returnUrl;</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;            <span class="keywordflow">if</span> (ModelState.IsValid)</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;            {</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;                <span class="comment">// This doesn&#39;t count login failures towards account lockout</span></div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;                <span class="comment">// To enable password failures to trigger account lockout, set lockoutOnFailure: true</span></div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;                var result = await _signInManager.PasswordSignInAsync(model.<a class="code" href="class_gameblasts_1_1_models_1_1_account_view_models_1_1_login_view_model.html#a918939e410c80fb7129ae4036ddb849a">Username</a>, model.<a class="code" href="class_gameblasts_1_1_models_1_1_account_view_models_1_1_login_view_model.html#a45b777ab88c3c73a5645a831c56e791e">Password</a>, model.<a class="code" href="class_gameblasts_1_1_models_1_1_account_view_models_1_1_login_view_model.html#a6556864bfd85b22eece6e13431ef23cb">RememberMe</a>, lockoutOnFailure: <span class="keyword">false</span>);</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;                <span class="keywordflow">if</span> (result.Succeeded)</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;                {</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;                    _logger.LogInformation(1, <span class="stringliteral">&quot;User logged in.&quot;</span>);</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;                    <span class="keywordflow">return</span> RedirectToLocal(returnUrl);</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;                }</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;                <span class="keywordflow">if</span> (result.RequiresTwoFactor)</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;                {</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;                    <span class="keywordflow">return</span> RedirectToAction(nameof(SendCode), <span class="keyword">new</span> { ReturnUrl = returnUrl, RememberMe = model.<a class="code" href="class_gameblasts_1_1_models_1_1_account_view_models_1_1_login_view_model.html#a6556864bfd85b22eece6e13431ef23cb">RememberMe</a> });</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;                }</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;                <span class="keywordflow">if</span> (result.IsLockedOut)</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;                {</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;                    _logger.LogWarning(2, <span class="stringliteral">&quot;User account locked out.&quot;</span>);</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;                    <span class="keywordflow">return</span> View(<span class="stringliteral">&quot;Lockout&quot;</span>);</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;                }</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;                <span class="keywordflow">else</span></div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;                {</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;                    ModelState.AddModelError(<span class="keywordtype">string</span>.Empty, <span class="stringliteral">&quot;Invalid login attempt.&quot;</span>);</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;                    <span class="keywordflow">return</span> View(model);</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;                }</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;            }</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;            <span class="comment">// If we got this far, something failed, redisplay form</span></div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;            <span class="keywordflow">return</span> View(model);</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;        }</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;        <span class="comment">//</span></div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        <span class="comment">// GET: /Account/Register</span></div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;        [HttpGet]</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;        [AllowAnonymous]</div><div class="line"><a name="l00097"></a><span class="lineno"><a class="line" href="class_gameblasts_1_1_controllers_1_1_account_controller.html#a4a1aeaaeb5117532654e422fa857cbe7">   97</a></span>&#160;        <span class="keyword">public</span> IActionResult <a class="code" href="class_gameblasts_1_1_controllers_1_1_account_controller.html#a4a1aeaaeb5117532654e422fa857cbe7">Register</a>(<span class="keywordtype">string</span> returnUrl = null)</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        {</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;            ViewData[<span class="stringliteral">&quot;ReturnUrl&quot;</span>] = returnUrl;</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;            <span class="keywordflow">return</span> View();</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        }</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        <span class="comment">//</span></div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        <span class="comment">// POST: /Account/Register</span></div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        [HttpPost]</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        [AllowAnonymous]</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        [ValidateAntiForgeryToken]</div><div class="line"><a name="l00108"></a><span class="lineno"><a class="line" href="class_gameblasts_1_1_controllers_1_1_account_controller.html#a81074857cc4837aee0ff83c47c2d665d">  108</a></span>&#160;        <span class="keyword">public</span> async Task&lt;IActionResult&gt; <a class="code" href="class_gameblasts_1_1_controllers_1_1_account_controller.html#a81074857cc4837aee0ff83c47c2d665d">Register</a>(<a class="code" href="class_gameblasts_1_1_models_1_1_account_view_models_1_1_register_view_model.html">RegisterViewModel</a> model, <span class="keywordtype">string</span> returnUrl = null)</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        {</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;            ViewData[<span class="stringliteral">&quot;ReturnUrl&quot;</span>] = returnUrl;</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;            <span class="keywordflow">if</span> (ModelState.IsValid)</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;            {</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;                var user = <span class="keyword">new</span> <a class="code" href="class_gameblasts_1_1_models_1_1_application_user.html">ApplicationUser</a> (model.<a class="code" href="class_gameblasts_1_1_models_1_1_account_view_models_1_1_register_view_model.html#a0ac3a4623bc1d653421b82118532f534">UserName</a>, model.<a class="code" href="class_gameblasts_1_1_models_1_1_account_view_models_1_1_register_view_model.html#af999ff9a75092c5dfe8293e1a4dc654e">Email</a>);</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;                var result = await _userManager.CreateAsync(user, model.<a class="code" href="class_gameblasts_1_1_models_1_1_account_view_models_1_1_register_view_model.html#a911cfbb10af0030f5c6032a950cdea34">Password</a>);</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;                <span class="keywordflow">if</span> (result.Succeeded)</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;                {</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;                    <span class="comment">// For more information on how to enable account confirmation and password reset please visit https://go.microsoft.com/fwlink/?LinkID=532713</span></div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;                    <span class="comment">// Send an email with this link</span></div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;                    <span class="comment">//var code = await _userManager.GenerateEmailConfirmationTokenAsync(user);</span></div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;                    <span class="comment">//var callbackUrl = Url.Action(nameof(ConfirmEmail), &quot;Account&quot;, new { userId = user.Id, code = code }, protocol: HttpContext.Request.Scheme);</span></div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;                    <span class="comment">//await _emailSender.SendEmailAsync(model.Email, &quot;Confirm your account&quot;,</span></div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;                    <span class="comment">//    $&quot;Please confirm your account by clicking this link: &lt;a href=&#39;{callbackUrl}&#39;&gt;link&lt;/a&gt;&quot;);</span></div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;                    await _signInManager.SignInAsync(user, isPersistent: <span class="keyword">false</span>);</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;                    await _userManager.AddToRoleAsync(user, <span class="stringliteral">&quot;Member&quot;</span>);</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;                    _logger.LogInformation(3, <span class="stringliteral">&quot;User created a new account with password.&quot;</span>);</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;                    <span class="keywordflow">return</span> RedirectToLocal(returnUrl);</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;                }</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;                AddErrors(result);</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;            }</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;            <span class="comment">// If we got this far, something failed, redisplay form</span></div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;            <span class="keywordflow">return</span> View(model);</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        }</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        <span class="comment">//</span></div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        <span class="comment">// POST: /Account/Logout</span></div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;        [HttpPost]</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;        [ValidateAntiForgeryToken]</div><div class="line"><a name="l00139"></a><span class="lineno"><a class="line" href="class_gameblasts_1_1_controllers_1_1_account_controller.html#a990ebf8512cbc920a2432163b9520cda">  139</a></span>&#160;        <span class="keyword">public</span> async Task&lt;IActionResult&gt; <a class="code" href="class_gameblasts_1_1_controllers_1_1_account_controller.html#a990ebf8512cbc920a2432163b9520cda">Logout</a>()</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;        {</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;            await _signInManager.SignOutAsync();</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;            _logger.LogInformation(4, <span class="stringliteral">&quot;User logged out.&quot;</span>);</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;            <span class="keywordflow">return</span> RedirectToAction(nameof(<a class="code" href="class_gameblasts_1_1_controllers_1_1_home_controller.html">HomeController</a>.<a class="code" href="class_gameblasts_1_1_controllers_1_1_home_controller.html#a2a54191af0467749dfbe76af0fff4f57">Index</a>), <span class="stringliteral">&quot;Home&quot;</span>);</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        }</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        <span class="comment">//</span></div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        <span class="comment">// POST: /Account/ExternalLogin</span></div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        [HttpPost]</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        [AllowAnonymous]</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;        [ValidateAntiForgeryToken]</div><div class="line"><a name="l00151"></a><span class="lineno"><a class="line" href="class_gameblasts_1_1_controllers_1_1_account_controller.html#a4857c5119b609a03477f21119a1a944d">  151</a></span>&#160;        <span class="keyword">public</span> IActionResult <a class="code" href="class_gameblasts_1_1_controllers_1_1_account_controller.html#a4857c5119b609a03477f21119a1a944d">ExternalLogin</a>(<span class="keywordtype">string</span> provider, <span class="keywordtype">string</span> returnUrl = null)</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        {</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;            <span class="comment">// Request a redirect to the external login provider.</span></div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;            var redirectUrl = Url.Action(nameof(ExternalLoginCallback), <span class="stringliteral">&quot;Account&quot;</span>, <span class="keyword">new</span> { ReturnUrl = returnUrl });</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;            var properties = _signInManager.ConfigureExternalAuthenticationProperties(provider, redirectUrl);</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;            <span class="keywordflow">return</span> Challenge(properties, provider);</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        }</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        <span class="comment">//</span></div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;        <span class="comment">// GET: /Account/ExternalLoginCallback</span></div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        [HttpGet]</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;        [AllowAnonymous]</div><div class="line"><a name="l00163"></a><span class="lineno"><a class="line" href="class_gameblasts_1_1_controllers_1_1_account_controller.html#a76a6fca1ff0dc35cf375b212c2d963ae">  163</a></span>&#160;        <span class="keyword">public</span> async Task&lt;IActionResult&gt; <a class="code" href="class_gameblasts_1_1_controllers_1_1_account_controller.html#a76a6fca1ff0dc35cf375b212c2d963ae">ExternalLoginCallback</a>(<span class="keywordtype">string</span> returnUrl = null, <span class="keywordtype">string</span> remoteError = null)</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;        {</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;            <span class="keywordflow">if</span> (remoteError != null)</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;            {</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;                ModelState.AddModelError(<span class="keywordtype">string</span>.Empty, $<span class="stringliteral">&quot;Error from external provider: {remoteError}&quot;</span>);</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;                <span class="keywordflow">return</span> View(nameof(Login));</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;            }</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;            var info = await _signInManager.GetExternalLoginInfoAsync();</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;            <span class="keywordflow">if</span> (info == null)</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;            {</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;                <span class="keywordflow">return</span> RedirectToAction(nameof(Login));</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;            }</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;            <span class="comment">// Sign in the user with this external login provider if the user already has a login.</span></div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;            var result = await _signInManager.ExternalLoginSignInAsync(info.LoginProvider, info.ProviderKey, isPersistent: <span class="keyword">false</span>);</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;            <span class="keywordflow">if</span> (result.Succeeded)</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;            {</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;                _logger.LogInformation(5, <span class="stringliteral">&quot;User logged in with {Name} provider.&quot;</span>, info.LoginProvider);</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;                <span class="keywordflow">return</span> RedirectToLocal(returnUrl);</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;            }</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;            <span class="keywordflow">if</span> (result.RequiresTwoFactor)</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;            {</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;                <span class="keywordflow">return</span> RedirectToAction(nameof(SendCode), <span class="keyword">new</span> { ReturnUrl = returnUrl });</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;            }</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;            <span class="keywordflow">if</span> (result.IsLockedOut)</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;            {</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;                <span class="keywordflow">return</span> View(<span class="stringliteral">&quot;Lockout&quot;</span>);</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;            }</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;            {</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;                <span class="comment">// If the user does not have an account, then ask the user to create an account.</span></div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;                ViewData[<span class="stringliteral">&quot;ReturnUrl&quot;</span>] = returnUrl;</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;                ViewData[<span class="stringliteral">&quot;LoginProvider&quot;</span>] = info.LoginProvider;</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;                var email = info.Principal.FindFirstValue(ClaimTypes.Email);</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;                <span class="keywordflow">return</span> View(<span class="stringliteral">&quot;ExternalLoginConfirmation&quot;</span>, <span class="keyword">new</span> <a class="code" href="class_gameblasts_1_1_models_1_1_account_view_models_1_1_external_login_confirmation_view_model.html">ExternalLoginConfirmationViewModel</a> { Email = email });</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;            }</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;        }</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;        <span class="comment">//</span></div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;        <span class="comment">// POST: /Account/ExternalLoginConfirmation</span></div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;        [HttpPost]</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        [AllowAnonymous]</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;        [ValidateAntiForgeryToken]</div><div class="line"><a name="l00206"></a><span class="lineno"><a class="line" href="class_gameblasts_1_1_controllers_1_1_account_controller.html#a2b04cb0d91d32217839607b888cefc92">  206</a></span>&#160;        <span class="keyword">public</span> async Task&lt;IActionResult&gt; <a class="code" href="class_gameblasts_1_1_controllers_1_1_account_controller.html#a2b04cb0d91d32217839607b888cefc92">ExternalLoginConfirmation</a>(<a class="code" href="class_gameblasts_1_1_models_1_1_account_view_models_1_1_external_login_confirmation_view_model.html">ExternalLoginConfirmationViewModel</a> model, <span class="keywordtype">string</span> returnUrl = null)</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;        {</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;            <span class="keywordflow">if</span> (ModelState.IsValid)</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;            {</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;                <span class="comment">// Get the information about the user from the external login provider</span></div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;                var info = await _signInManager.GetExternalLoginInfoAsync();</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;                <span class="keywordflow">if</span> (info == null)</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;                {</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;                    <span class="keywordflow">return</span> View(<span class="stringliteral">&quot;ExternalLoginFailure&quot;</span>);</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;                }</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;                var user = <span class="keyword">new</span> <a class="code" href="class_gameblasts_1_1_models_1_1_application_user.html">ApplicationUser</a> (model.<a class="code" href="class_gameblasts_1_1_models_1_1_account_view_models_1_1_external_login_confirmation_view_model.html#ace1d94c86cb694d16339e6fdefde58fe">Email</a>, model.<a class="code" href="class_gameblasts_1_1_models_1_1_account_view_models_1_1_external_login_confirmation_view_model.html#ace1d94c86cb694d16339e6fdefde58fe">Email</a> );</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;                var result = await _userManager.CreateAsync(user);</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;                <span class="keywordflow">if</span> (result.Succeeded)</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;                {</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;                    result = await _userManager.AddLoginAsync(user, info);</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;                    <span class="keywordflow">if</span> (result.Succeeded)</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;                    {</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;                        await _signInManager.SignInAsync(user, isPersistent: <span class="keyword">false</span>);</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;                        _logger.LogInformation(6, <span class="stringliteral">&quot;User created an account using {Name} provider.&quot;</span>, info.LoginProvider);</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;                        <span class="keywordflow">return</span> RedirectToLocal(returnUrl);</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;                    }</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;                }</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;                AddErrors(result);</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;            }</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;            ViewData[<span class="stringliteral">&quot;ReturnUrl&quot;</span>] = returnUrl;</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;            <span class="keywordflow">return</span> View(model);</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;        }</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;        <span class="comment">// GET: /Account/ConfirmEmail</span></div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;        [HttpGet]</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;        [AllowAnonymous]</div><div class="line"><a name="l00238"></a><span class="lineno"><a class="line" href="class_gameblasts_1_1_controllers_1_1_account_controller.html#a982c56fe541631474ae054d49f67af0a">  238</a></span>&#160;        <span class="keyword">public</span> async Task&lt;IActionResult&gt; <a class="code" href="class_gameblasts_1_1_controllers_1_1_account_controller.html#a982c56fe541631474ae054d49f67af0a">ConfirmEmail</a>(<span class="keywordtype">string</span> userId, <span class="keywordtype">string</span> code)</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;        {</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;            <span class="keywordflow">if</span> (userId == null || code == null)</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;            {</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;                <span class="keywordflow">return</span> View(<span class="stringliteral">&quot;Error&quot;</span>);</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;            }</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;            var user = await _userManager.FindByIdAsync(userId);</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;            <span class="keywordflow">if</span> (user == null)</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;            {</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;                <span class="keywordflow">return</span> View(<span class="stringliteral">&quot;Error&quot;</span>);</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;            }</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;            var result = await _userManager.ConfirmEmailAsync(user, code);</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;            <span class="keywordflow">return</span> View(result.Succeeded ? <span class="stringliteral">&quot;ConfirmEmail&quot;</span> : <span class="stringliteral">&quot;Error&quot;</span>);</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;        }</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;        <span class="comment">//</span></div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;        <span class="comment">// GET: /Account/ForgotPassword</span></div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;        [HttpGet]</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;        [AllowAnonymous]</div><div class="line"><a name="l00257"></a><span class="lineno"><a class="line" href="class_gameblasts_1_1_controllers_1_1_account_controller.html#a0a323e76dde57001073b79763b038fdc">  257</a></span>&#160;        <span class="keyword">public</span> IActionResult <a class="code" href="class_gameblasts_1_1_controllers_1_1_account_controller.html#a0a323e76dde57001073b79763b038fdc">ForgotPassword</a>()</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;        {</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;            <span class="keywordflow">return</span> View();</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;        }</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;        <span class="comment">//</span></div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;        <span class="comment">// POST: /Account/ForgotPassword</span></div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;        [HttpPost]</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;        [AllowAnonymous]</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;        [ValidateAntiForgeryToken]</div><div class="line"><a name="l00267"></a><span class="lineno"><a class="line" href="class_gameblasts_1_1_controllers_1_1_account_controller.html#aafbb8e5973e59abd35e79ff00bea602b">  267</a></span>&#160;        <span class="keyword">public</span> async Task&lt;IActionResult&gt; <a class="code" href="class_gameblasts_1_1_controllers_1_1_account_controller.html#aafbb8e5973e59abd35e79ff00bea602b">ForgotPassword</a>(<a class="code" href="class_gameblasts_1_1_models_1_1_account_view_models_1_1_forgot_password_view_model.html">ForgotPasswordViewModel</a> model)</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;        {</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;            <span class="keywordflow">if</span> (ModelState.IsValid)</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;            {</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;                var user = await _userManager.FindByEmailAsync(model.<a class="code" href="class_gameblasts_1_1_models_1_1_account_view_models_1_1_forgot_password_view_model.html#acc54641d7188b8c0372f9b7e9b4a1f87">Email</a>);</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;                <span class="keywordflow">if</span> (user == null || !(await _userManager.IsEmailConfirmedAsync(user)))</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;                {</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;                    <span class="comment">// Don&#39;t reveal that the user does not exist or is not confirmed</span></div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;                    <span class="keywordflow">return</span> View(<span class="stringliteral">&quot;ForgotPasswordConfirmation&quot;</span>);</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;                }</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;                <span class="comment">// For more information on how to enable account confirmation and password reset please visit https://go.microsoft.com/fwlink/?LinkID=532713</span></div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;                <span class="comment">// Send an email with this link</span></div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;                <span class="comment">//var code = await _userManager.GeneratePasswordResetTokenAsync(user);</span></div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;                <span class="comment">//var callbackUrl = Url.Action(nameof(ResetPassword), &quot;Account&quot;, new { userId = user.Id, code = code }, protocol: HttpContext.Request.Scheme);</span></div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;                <span class="comment">//await _emailSender.SendEmailAsync(model.Email, &quot;Reset Password&quot;,</span></div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;                <span class="comment">//   $&quot;Please reset your password by clicking here: &lt;a href=&#39;{callbackUrl}&#39;&gt;link&lt;/a&gt;&quot;);</span></div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;                <span class="comment">//return View(&quot;ForgotPasswordConfirmation&quot;);</span></div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;            }</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;            <span class="comment">// If we got this far, something failed, redisplay form</span></div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;            <span class="keywordflow">return</span> View(model);</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;        }</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;        <span class="comment">//</span></div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;        <span class="comment">// GET: /Account/ForgotPasswordConfirmation</span></div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;        [HttpGet]</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;        [AllowAnonymous]</div><div class="line"><a name="l00295"></a><span class="lineno"><a class="line" href="class_gameblasts_1_1_controllers_1_1_account_controller.html#a920262eb2f1045bd9a133174f95f1dfa">  295</a></span>&#160;        <span class="keyword">public</span> IActionResult <a class="code" href="class_gameblasts_1_1_controllers_1_1_account_controller.html#a920262eb2f1045bd9a133174f95f1dfa">ForgotPasswordConfirmation</a>()</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;        {</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;            <span class="keywordflow">return</span> View();</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;        }</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;        <span class="comment">//</span></div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;        <span class="comment">// GET: /Account/ResetPassword</span></div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;        [HttpGet]</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;        [AllowAnonymous]</div><div class="line"><a name="l00304"></a><span class="lineno"><a class="line" href="class_gameblasts_1_1_controllers_1_1_account_controller.html#a8d1296221b26ccfc55c92306c953bd4c">  304</a></span>&#160;        <span class="keyword">public</span> IActionResult <a class="code" href="class_gameblasts_1_1_controllers_1_1_account_controller.html#a8d1296221b26ccfc55c92306c953bd4c">ResetPassword</a>(<span class="keywordtype">string</span> code = null)</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;        {</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;            <span class="keywordflow">return</span> code == null ? View(<span class="stringliteral">&quot;Error&quot;</span>) : View();</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;        }</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;        <span class="comment">//</span></div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;        <span class="comment">// POST: /Account/ResetPassword</span></div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;        [HttpPost]</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;        [AllowAnonymous]</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;        [ValidateAntiForgeryToken]</div><div class="line"><a name="l00314"></a><span class="lineno"><a class="line" href="class_gameblasts_1_1_controllers_1_1_account_controller.html#ae3ed950c22e7ce7c9b80da652ac0ed7f">  314</a></span>&#160;        <span class="keyword">public</span> async Task&lt;IActionResult&gt; <a class="code" href="class_gameblasts_1_1_controllers_1_1_account_controller.html#ae3ed950c22e7ce7c9b80da652ac0ed7f">ResetPassword</a>(<a class="code" href="class_gameblasts_1_1_models_1_1_account_view_models_1_1_reset_password_view_model.html">ResetPasswordViewModel</a> model)</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;        {</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;            <span class="keywordflow">if</span> (!ModelState.IsValid)</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;            {</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;                <span class="keywordflow">return</span> View(model);</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;            }</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;            var user = await _userManager.FindByEmailAsync(model.<a class="code" href="class_gameblasts_1_1_models_1_1_account_view_models_1_1_reset_password_view_model.html#a488fad8cf73d37a483116f66b76261d3">Email</a>);</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;            <span class="keywordflow">if</span> (user == null)</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;            {</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;                <span class="comment">// Don&#39;t reveal that the user does not exist</span></div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;                <span class="keywordflow">return</span> RedirectToAction(nameof(<a class="code" href="class_gameblasts_1_1_controllers_1_1_account_controller.html">AccountController</a>.<a class="code" href="class_gameblasts_1_1_controllers_1_1_account_controller.html#aa294b6ba404633b45ff18bfb250ac138">ResetPasswordConfirmation</a>), <span class="stringliteral">&quot;Account&quot;</span>);</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;            }</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;            var result = await _userManager.ResetPasswordAsync(user, model.<a class="code" href="class_gameblasts_1_1_models_1_1_account_view_models_1_1_reset_password_view_model.html#a45ce253547809e63da2ac226e5784c65">Code</a>, model.<a class="code" href="class_gameblasts_1_1_models_1_1_account_view_models_1_1_reset_password_view_model.html#a58cd70ea2e86a480dd57f0e15f17e4ec">Password</a>);</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;            <span class="keywordflow">if</span> (result.Succeeded)</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;            {</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;                <span class="keywordflow">return</span> RedirectToAction(nameof(<a class="code" href="class_gameblasts_1_1_controllers_1_1_account_controller.html">AccountController</a>.<a class="code" href="class_gameblasts_1_1_controllers_1_1_account_controller.html#aa294b6ba404633b45ff18bfb250ac138">ResetPasswordConfirmation</a>), <span class="stringliteral">&quot;Account&quot;</span>);</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;            }</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;            AddErrors(result);</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;            <span class="keywordflow">return</span> View();</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;        }</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;        <span class="comment">//</span></div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;        <span class="comment">// GET: /Account/ResetPasswordConfirmation</span></div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;        [HttpGet]</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;        [AllowAnonymous]</div><div class="line"><a name="l00339"></a><span class="lineno"><a class="line" href="class_gameblasts_1_1_controllers_1_1_account_controller.html#aa294b6ba404633b45ff18bfb250ac138">  339</a></span>&#160;        <span class="keyword">public</span> IActionResult <a class="code" href="class_gameblasts_1_1_controllers_1_1_account_controller.html#aa294b6ba404633b45ff18bfb250ac138">ResetPasswordConfirmation</a>()</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;        {</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;            <span class="keywordflow">return</span> View();</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;        }</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;        <span class="comment">//</span></div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;        <span class="comment">// GET: /Account/SendCode</span></div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;        [HttpGet]</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;        [AllowAnonymous]</div><div class="line"><a name="l00348"></a><span class="lineno"><a class="line" href="class_gameblasts_1_1_controllers_1_1_account_controller.html#a4704fe7c5fb45980c24154fda370450d">  348</a></span>&#160;        <span class="keyword">public</span> async Task&lt;ActionResult&gt; <a class="code" href="class_gameblasts_1_1_controllers_1_1_account_controller.html#a4704fe7c5fb45980c24154fda370450d">SendCode</a>(<span class="keywordtype">string</span> returnUrl = null, <span class="keywordtype">bool</span> rememberMe = <span class="keyword">false</span>)</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;        {</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;            var user = await _signInManager.GetTwoFactorAuthenticationUserAsync();</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;            <span class="keywordflow">if</span> (user == null)</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;            {</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;                <span class="keywordflow">return</span> View(<span class="stringliteral">&quot;Error&quot;</span>);</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;            }</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;            var userFactors = await _userManager.GetValidTwoFactorProvidersAsync(user);</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;            var factorOptions = userFactors.Select(purpose =&gt; <span class="keyword">new</span> SelectListItem { Text = purpose, Value = purpose }).ToList();</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;            <span class="keywordflow">return</span> View(<span class="keyword">new</span> <a class="code" href="class_gameblasts_1_1_models_1_1_account_view_models_1_1_send_code_view_model.html">SendCodeViewModel</a> { Providers = factorOptions, ReturnUrl = returnUrl, RememberMe = rememberMe });</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;        }</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;        <span class="comment">//</span></div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;        <span class="comment">// POST: /Account/SendCode</span></div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;        [HttpPost]</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;        [AllowAnonymous]</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;        [ValidateAntiForgeryToken]</div><div class="line"><a name="l00365"></a><span class="lineno"><a class="line" href="class_gameblasts_1_1_controllers_1_1_account_controller.html#a002fdc3e12296f914ea3880fdfad2b74">  365</a></span>&#160;        <span class="keyword">public</span> async Task&lt;IActionResult&gt; <a class="code" href="class_gameblasts_1_1_controllers_1_1_account_controller.html#a002fdc3e12296f914ea3880fdfad2b74">SendCode</a>(<a class="code" href="class_gameblasts_1_1_models_1_1_account_view_models_1_1_send_code_view_model.html">SendCodeViewModel</a> model)</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;        {</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;            <span class="keywordflow">if</span> (!ModelState.IsValid)</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;            {</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;                <span class="keywordflow">return</span> View();</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;            }</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;            var user = await _signInManager.GetTwoFactorAuthenticationUserAsync();</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;            <span class="keywordflow">if</span> (user == null)</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;            {</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;                <span class="keywordflow">return</span> View(<span class="stringliteral">&quot;Error&quot;</span>);</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;            }</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;            <span class="comment">// Generate the token and send it</span></div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;            var code = await _userManager.GenerateTwoFactorTokenAsync(user, model.<a class="code" href="class_gameblasts_1_1_models_1_1_account_view_models_1_1_send_code_view_model.html#a0ea5b311995f3f061359f2cbc154716c">SelectedProvider</a>);</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;            <span class="keywordflow">if</span> (<span class="keywordtype">string</span>.IsNullOrWhiteSpace(code))</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;            {</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;                <span class="keywordflow">return</span> View(<span class="stringliteral">&quot;Error&quot;</span>);</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;            }</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;            var message = <span class="stringliteral">&quot;Your security code is: &quot;</span> + code;</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;            <span class="keywordflow">if</span> (model.<a class="code" href="class_gameblasts_1_1_models_1_1_account_view_models_1_1_send_code_view_model.html#a0ea5b311995f3f061359f2cbc154716c">SelectedProvider</a> == <span class="stringliteral">&quot;Email&quot;</span>)</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;            {</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;                await _emailSender.SendEmailAsync(await _userManager.GetEmailAsync(user), <span class="stringliteral">&quot;Security Code&quot;</span>, message);</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;            }</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (model.<a class="code" href="class_gameblasts_1_1_models_1_1_account_view_models_1_1_send_code_view_model.html#a0ea5b311995f3f061359f2cbc154716c">SelectedProvider</a> == <span class="stringliteral">&quot;Phone&quot;</span>)</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;            {</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;                await _smsSender.SendSmsAsync(await _userManager.GetPhoneNumberAsync(user), message);</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;            }</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;            <span class="keywordflow">return</span> RedirectToAction(nameof(VerifyCode), <span class="keyword">new</span> { Provider = model.<a class="code" href="class_gameblasts_1_1_models_1_1_account_view_models_1_1_send_code_view_model.html#a0ea5b311995f3f061359f2cbc154716c">SelectedProvider</a>, ReturnUrl = model.<a class="code" href="class_gameblasts_1_1_models_1_1_account_view_models_1_1_send_code_view_model.html#acc7bfd167ef66d51bf151d8ef74036f6">ReturnUrl</a>, RememberMe = model.<a class="code" href="class_gameblasts_1_1_models_1_1_account_view_models_1_1_send_code_view_model.html#a35f8744de18b302f8d7a37ae31ff9470">RememberMe</a> });</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;        }</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;        <span class="comment">//</span></div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;        <span class="comment">// GET: /Account/VerifyCode</span></div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;        [HttpGet]</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;        [AllowAnonymous]</div><div class="line"><a name="l00402"></a><span class="lineno"><a class="line" href="class_gameblasts_1_1_controllers_1_1_account_controller.html#ad583a58ae1caab8008bbdcad17ef6f2e">  402</a></span>&#160;        <span class="keyword">public</span> async Task&lt;IActionResult&gt; <a class="code" href="class_gameblasts_1_1_controllers_1_1_account_controller.html#ad583a58ae1caab8008bbdcad17ef6f2e">VerifyCode</a>(<span class="keywordtype">string</span> provider, <span class="keywordtype">bool</span> rememberMe, <span class="keywordtype">string</span> returnUrl = null)</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;        {</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;            <span class="comment">// Require that the user has already logged in via username/password or external login</span></div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;            var user = await _signInManager.GetTwoFactorAuthenticationUserAsync();</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;            <span class="keywordflow">if</span> (user == null)</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;            {</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;                <span class="keywordflow">return</span> View(<span class="stringliteral">&quot;Error&quot;</span>);</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;            }</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;            <span class="keywordflow">return</span> View(<span class="keyword">new</span> <a class="code" href="class_gameblasts_1_1_models_1_1_account_view_models_1_1_verify_code_view_model.html">VerifyCodeViewModel</a> { Provider = provider, ReturnUrl = returnUrl, RememberMe = rememberMe });</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;        }</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;        <span class="comment">//</span></div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;        <span class="comment">// POST: /Account/VerifyCode</span></div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;        [HttpPost]</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;        [AllowAnonymous]</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;        [ValidateAntiForgeryToken]</div><div class="line"><a name="l00418"></a><span class="lineno"><a class="line" href="class_gameblasts_1_1_controllers_1_1_account_controller.html#add184fcda15e5cf17e62460f1305b002">  418</a></span>&#160;        <span class="keyword">public</span> async Task&lt;IActionResult&gt; <a class="code" href="class_gameblasts_1_1_controllers_1_1_account_controller.html#add184fcda15e5cf17e62460f1305b002">VerifyCode</a>(<a class="code" href="class_gameblasts_1_1_models_1_1_account_view_models_1_1_verify_code_view_model.html">VerifyCodeViewModel</a> model)</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;        {</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;            <span class="keywordflow">if</span> (!ModelState.IsValid)</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;            {</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;                <span class="keywordflow">return</span> View(model);</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;            }</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;            <span class="comment">// The following code protects for brute force attacks against the two factor codes.</span></div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;            <span class="comment">// If a user enters incorrect codes for a specified amount of time then the user account</span></div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;            <span class="comment">// will be locked out for a specified amount of time.</span></div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;            var result = await _signInManager.TwoFactorSignInAsync(model.<a class="code" href="class_gameblasts_1_1_models_1_1_account_view_models_1_1_verify_code_view_model.html#a6b36b531c345c1269670474bca8a10d0">Provider</a>, model.<a class="code" href="class_gameblasts_1_1_models_1_1_account_view_models_1_1_verify_code_view_model.html#a59baa4f1101cd1a104d25ff882295456">Code</a>, model.<a class="code" href="class_gameblasts_1_1_models_1_1_account_view_models_1_1_verify_code_view_model.html#a71670534247e55b2477e2859fad982e9">RememberMe</a>, model.<a class="code" href="class_gameblasts_1_1_models_1_1_account_view_models_1_1_verify_code_view_model.html#ac38c932dcbdf4e49f8c849c8ddce4f37">RememberBrowser</a>);</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;            <span class="keywordflow">if</span> (result.Succeeded)</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;            {</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;                <span class="keywordflow">return</span> RedirectToLocal(model.<a class="code" href="class_gameblasts_1_1_models_1_1_account_view_models_1_1_verify_code_view_model.html#a50e1f08c64bab932f817e50e310dcab0">ReturnUrl</a>);</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;            }</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;            <span class="keywordflow">if</span> (result.IsLockedOut)</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;            {</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;                _logger.LogWarning(7, <span class="stringliteral">&quot;User account locked out.&quot;</span>);</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;                <span class="keywordflow">return</span> View(<span class="stringliteral">&quot;Lockout&quot;</span>);</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;            }</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;            {</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;                ModelState.AddModelError(<span class="keywordtype">string</span>.Empty, <span class="stringliteral">&quot;Invalid code.&quot;</span>);</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;                <span class="keywordflow">return</span> View(model);</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;            }</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;        }</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;        <span class="comment">//</span></div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;        <span class="comment">// GET /Account/AccessDenied</span></div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;        [HttpGet]</div><div class="line"><a name="l00448"></a><span class="lineno"><a class="line" href="class_gameblasts_1_1_controllers_1_1_account_controller.html#a01c414185b228bc65e2d7a3c0665a7a2">  448</a></span>&#160;        <span class="keyword">public</span> IActionResult <a class="code" href="class_gameblasts_1_1_controllers_1_1_account_controller.html#a01c414185b228bc65e2d7a3c0665a7a2">AccessDenied</a>()</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;        {</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;            <span class="keywordflow">return</span> View();</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;        }</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;<span class="preprocessor">        #region Helpers</span></div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;        <span class="keyword">private</span> <span class="keywordtype">void</span> AddErrors(IdentityResult result)</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;        {</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;            <span class="keywordflow">foreach</span> (var error <span class="keywordflow">in</span> result.Errors)</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;            {</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;                ModelState.AddModelError(<span class="keywordtype">string</span>.Empty, error.Description);</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;            }</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;        }</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;        <span class="keyword">private</span> IActionResult RedirectToLocal(<span class="keywordtype">string</span> returnUrl)</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;        {</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;            <span class="keywordflow">if</span> (Url.IsLocalUrl(returnUrl))</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;            {</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;                <span class="keywordflow">return</span> Redirect(returnUrl);</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;            }</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;            {</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;                <span class="keywordflow">return</span> RedirectToAction(nameof(<a class="code" href="class_gameblasts_1_1_controllers_1_1_home_controller.html">HomeController</a>.<a class="code" href="class_gameblasts_1_1_controllers_1_1_home_controller.html#a2a54191af0467749dfbe76af0fff4f57">Index</a>), <span class="stringliteral">&quot;Home&quot;</span>);</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;            }</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;        }</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;<span class="preprocessor">        #endregion</span></div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    }</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;}</div><div class="ttc" id="class_gameblasts_1_1_models_1_1_account_view_models_1_1_register_view_model_html_a0ac3a4623bc1d653421b82118532f534"><div class="ttname"><a href="class_gameblasts_1_1_models_1_1_account_view_models_1_1_register_view_model.html#a0ac3a4623bc1d653421b82118532f534">Gameblasts.Models.AccountViewModels.RegisterViewModel.UserName</a></div><div class="ttdeci">string UserName</div><div class="ttdef"><b>Definition:</b> <a href="_register_view_model_8cs_source.html#l00009">RegisterViewModel.cs:9</a></div></div>
<div class="ttc" id="class_gameblasts_1_1_models_1_1_account_view_models_1_1_register_view_model_html_a911cfbb10af0030f5c6032a950cdea34"><div class="ttname"><a href="class_gameblasts_1_1_models_1_1_account_view_models_1_1_register_view_model.html#a911cfbb10af0030f5c6032a950cdea34">Gameblasts.Models.AccountViewModels.RegisterViewModel.Password</a></div><div class="ttdeci">string Password</div><div class="ttdef"><b>Definition:</b> <a href="_register_view_model_8cs_source.html#l00020">RegisterViewModel.cs:20</a></div></div>
<div class="ttc" id="class_gameblasts_1_1_controllers_1_1_account_controller_html_a2b04cb0d91d32217839607b888cefc92"><div class="ttname"><a href="class_gameblasts_1_1_controllers_1_1_account_controller.html#a2b04cb0d91d32217839607b888cefc92">Gameblasts.Controllers.AccountController.ExternalLoginConfirmation</a></div><div class="ttdeci">async Task&lt; IActionResult &gt; ExternalLoginConfirmation(ExternalLoginConfirmationViewModel model, string returnUrl=null)</div><div class="ttdef"><b>Definition:</b> <a href="_account_controller_8cs_source.html#l00206">AccountController.cs:206</a></div></div>
<div class="ttc" id="namespace_gameblasts_1_1_services_html"><div class="ttname"><a href="namespace_gameblasts_1_1_services.html">Gameblasts.Services</a></div><div class="ttdef"><b>Definition:</b> <a href="_i_email_sender_8cs_source.html#l00003">IEmailSender.cs:3</a></div></div>
<div class="ttc" id="class_gameblasts_1_1_models_1_1_account_view_models_1_1_reset_password_view_model_html"><div class="ttname"><a href="class_gameblasts_1_1_models_1_1_account_view_models_1_1_reset_password_view_model.html">Gameblasts.Models.AccountViewModels.ResetPasswordViewModel</a></div><div class="ttdef"><b>Definition:</b> <a href="_reset_password_view_model_8cs_source.html#l00005">ResetPasswordViewModel.cs:5</a></div></div>
<div class="ttc" id="class_gameblasts_1_1_controllers_1_1_account_controller_html_a920262eb2f1045bd9a133174f95f1dfa"><div class="ttname"><a href="class_gameblasts_1_1_controllers_1_1_account_controller.html#a920262eb2f1045bd9a133174f95f1dfa">Gameblasts.Controllers.AccountController.ForgotPasswordConfirmation</a></div><div class="ttdeci">IActionResult ForgotPasswordConfirmation()</div><div class="ttdef"><b>Definition:</b> <a href="_account_controller_8cs_source.html#l00295">AccountController.cs:295</a></div></div>
<div class="ttc" id="class_gameblasts_1_1_controllers_1_1_home_controller_html"><div class="ttname"><a href="class_gameblasts_1_1_controllers_1_1_home_controller.html">Gameblasts.Controllers.HomeController</a></div><div class="ttdef"><b>Definition:</b> <a href="_home_controller_8cs_source.html#l00011">HomeController.cs:11</a></div></div>
<div class="ttc" id="class_gameblasts_1_1_models_1_1_account_view_models_1_1_external_login_confirmation_view_model_html_ace1d94c86cb694d16339e6fdefde58fe"><div class="ttname"><a href="class_gameblasts_1_1_models_1_1_account_view_models_1_1_external_login_confirmation_view_model.html#ace1d94c86cb694d16339e6fdefde58fe">Gameblasts.Models.AccountViewModels.ExternalLoginConfirmationViewModel.Email</a></div><div class="ttdeci">string Email</div><div class="ttdef"><b>Definition:</b> <a href="_external_login_confirmation_view_model_8cs_source.html#l00009">ExternalLoginConfirmationViewModel.cs:9</a></div></div>
<div class="ttc" id="class_gameblasts_1_1_models_1_1_account_view_models_1_1_verify_code_view_model_html_a50e1f08c64bab932f817e50e310dcab0"><div class="ttname"><a href="class_gameblasts_1_1_models_1_1_account_view_models_1_1_verify_code_view_model.html#a50e1f08c64bab932f817e50e310dcab0">Gameblasts.Models.AccountViewModels.VerifyCodeViewModel.ReturnUrl</a></div><div class="ttdeci">string ReturnUrl</div><div class="ttdef"><b>Definition:</b> <a href="_verify_code_view_model_8cs_source.html#l00013">VerifyCodeViewModel.cs:13</a></div></div>
<div class="ttc" id="class_gameblasts_1_1_models_1_1_account_view_models_1_1_verify_code_view_model_html_a71670534247e55b2477e2859fad982e9"><div class="ttname"><a href="class_gameblasts_1_1_models_1_1_account_view_models_1_1_verify_code_view_model.html#a71670534247e55b2477e2859fad982e9">Gameblasts.Models.AccountViewModels.VerifyCodeViewModel.RememberMe</a></div><div class="ttdeci">bool RememberMe</div><div class="ttdef"><b>Definition:</b> <a href="_verify_code_view_model_8cs_source.html#l00019">VerifyCodeViewModel.cs:19</a></div></div>
<div class="ttc" id="class_gameblasts_1_1_models_1_1_application_user_html"><div class="ttname"><a href="class_gameblasts_1_1_models_1_1_application_user.html">Gameblasts.Models.ApplicationUser</a></div><div class="ttdoc">ApplicationUser class: Parameter: UserName(string), Email(string) Properties: ImgAdress(string, url to the profile image), MemberTitle(string, ranking system in forum), Location(string, user location), Gender(string), SocialMediaNames(string), Age(int, user age), PostCount(int, count of posts made by user), MsgSent(int, count of msgs sent by user, not working), UnreadMsg(bool, true if user got an unread msg), RegisterDate(Date), Posts(Post, List of posts the user has made), Messages(Message, List of messages the user had made, not working). </div><div class="ttdef"><b>Definition:</b> <a href="_application_user_8cs_source.html#l00022">ApplicationUser.cs:22</a></div></div>
<div class="ttc" id="namespace_system_html"><div class="ttname"><a href="namespace_system.html">System</a></div></div>
<div class="ttc" id="class_gameblasts_1_1_models_1_1_account_view_models_1_1_login_view_model_html_a918939e410c80fb7129ae4036ddb849a"><div class="ttname"><a href="class_gameblasts_1_1_models_1_1_account_view_models_1_1_login_view_model.html#a918939e410c80fb7129ae4036ddb849a">Gameblasts.Models.AccountViewModels.LoginViewModel.Username</a></div><div class="ttdeci">string Username</div><div class="ttdef"><b>Definition:</b> <a href="_login_view_model_8cs_source.html#l00008">LoginViewModel.cs:8</a></div></div>
<div class="ttc" id="class_gameblasts_1_1_models_1_1_account_view_models_1_1_send_code_view_model_html_a0ea5b311995f3f061359f2cbc154716c"><div class="ttname"><a href="class_gameblasts_1_1_models_1_1_account_view_models_1_1_send_code_view_model.html#a0ea5b311995f3f061359f2cbc154716c">Gameblasts.Models.AccountViewModels.SendCodeViewModel.SelectedProvider</a></div><div class="ttdeci">string SelectedProvider</div><div class="ttdef"><b>Definition:</b> <a href="_send_code_view_model_8cs_source.html#l00008">SendCodeViewModel.cs:8</a></div></div>
<div class="ttc" id="class_gameblasts_1_1_models_1_1_account_view_models_1_1_forgot_password_view_model_html_acc54641d7188b8c0372f9b7e9b4a1f87"><div class="ttname"><a href="class_gameblasts_1_1_models_1_1_account_view_models_1_1_forgot_password_view_model.html#acc54641d7188b8c0372f9b7e9b4a1f87">Gameblasts.Models.AccountViewModels.ForgotPasswordViewModel.Email</a></div><div class="ttdeci">string Email</div><div class="ttdef"><b>Definition:</b> <a href="_forgot_password_view_model_8cs_source.html#l00009">ForgotPasswordViewModel.cs:9</a></div></div>
<div class="ttc" id="class_gameblasts_1_1_models_1_1_account_view_models_1_1_login_view_model_html_a45b777ab88c3c73a5645a831c56e791e"><div class="ttname"><a href="class_gameblasts_1_1_models_1_1_account_view_models_1_1_login_view_model.html#a45b777ab88c3c73a5645a831c56e791e">Gameblasts.Models.AccountViewModels.LoginViewModel.Password</a></div><div class="ttdeci">string Password</div><div class="ttdef"><b>Definition:</b> <a href="_login_view_model_8cs_source.html#l00012">LoginViewModel.cs:12</a></div></div>
<div class="ttc" id="class_gameblasts_1_1_controllers_1_1_account_controller_html_a002fdc3e12296f914ea3880fdfad2b74"><div class="ttname"><a href="class_gameblasts_1_1_controllers_1_1_account_controller.html#a002fdc3e12296f914ea3880fdfad2b74">Gameblasts.Controllers.AccountController.SendCode</a></div><div class="ttdeci">async Task&lt; IActionResult &gt; SendCode(SendCodeViewModel model)</div><div class="ttdef"><b>Definition:</b> <a href="_account_controller_8cs_source.html#l00365">AccountController.cs:365</a></div></div>
<div class="ttc" id="class_gameblasts_1_1_controllers_1_1_account_controller_html_a4a1aeaaeb5117532654e422fa857cbe7"><div class="ttname"><a href="class_gameblasts_1_1_controllers_1_1_account_controller.html#a4a1aeaaeb5117532654e422fa857cbe7">Gameblasts.Controllers.AccountController.Register</a></div><div class="ttdeci">IActionResult Register(string returnUrl=null)</div><div class="ttdef"><b>Definition:</b> <a href="_account_controller_8cs_source.html#l00097">AccountController.cs:97</a></div></div>
<div class="ttc" id="class_gameblasts_1_1_controllers_1_1_account_controller_html_a990ebf8512cbc920a2432163b9520cda"><div class="ttname"><a href="class_gameblasts_1_1_controllers_1_1_account_controller.html#a990ebf8512cbc920a2432163b9520cda">Gameblasts.Controllers.AccountController.Logout</a></div><div class="ttdeci">async Task&lt; IActionResult &gt; Logout()</div><div class="ttdef"><b>Definition:</b> <a href="_account_controller_8cs_source.html#l00139">AccountController.cs:139</a></div></div>
<div class="ttc" id="class_gameblasts_1_1_models_1_1_account_view_models_1_1_register_view_model_html"><div class="ttname"><a href="class_gameblasts_1_1_models_1_1_account_view_models_1_1_register_view_model.html">Gameblasts.Models.AccountViewModels.RegisterViewModel</a></div><div class="ttdef"><b>Definition:</b> <a href="_register_view_model_8cs_source.html#l00005">RegisterViewModel.cs:5</a></div></div>
<div class="ttc" id="class_gameblasts_1_1_controllers_1_1_account_controller_html_ae3ed950c22e7ce7c9b80da652ac0ed7f"><div class="ttname"><a href="class_gameblasts_1_1_controllers_1_1_account_controller.html#ae3ed950c22e7ce7c9b80da652ac0ed7f">Gameblasts.Controllers.AccountController.ResetPassword</a></div><div class="ttdeci">async Task&lt; IActionResult &gt; ResetPassword(ResetPasswordViewModel model)</div><div class="ttdef"><b>Definition:</b> <a href="_account_controller_8cs_source.html#l00314">AccountController.cs:314</a></div></div>
<div class="ttc" id="interface_gameblasts_1_1_services_1_1_i_sms_sender_html"><div class="ttname"><a href="interface_gameblasts_1_1_services_1_1_i_sms_sender.html">Gameblasts.Services.ISmsSender</a></div><div class="ttdef"><b>Definition:</b> <a href="_i_sms_sender_8cs_source.html#l00005">ISmsSender.cs:5</a></div></div>
<div class="ttc" id="class_gameblasts_1_1_models_1_1_account_view_models_1_1_verify_code_view_model_html_a6b36b531c345c1269670474bca8a10d0"><div class="ttname"><a href="class_gameblasts_1_1_models_1_1_account_view_models_1_1_verify_code_view_model.html#a6b36b531c345c1269670474bca8a10d0">Gameblasts.Models.AccountViewModels.VerifyCodeViewModel.Provider</a></div><div class="ttdeci">string Provider</div><div class="ttdef"><b>Definition:</b> <a href="_verify_code_view_model_8cs_source.html#l00008">VerifyCodeViewModel.cs:8</a></div></div>
<div class="ttc" id="class_gameblasts_1_1_controllers_1_1_account_controller_html_ae98fb9f4e88ef8c55fe61d45324d7098"><div class="ttname"><a href="class_gameblasts_1_1_controllers_1_1_account_controller.html#ae98fb9f4e88ef8c55fe61d45324d7098">Gameblasts.Controllers.AccountController.AccountController</a></div><div class="ttdeci">AccountController(UserManager&lt; ApplicationUser &gt; userManager, SignInManager&lt; ApplicationUser &gt; signInManager, IOptions&lt; IdentityCookieOptions &gt; identityCookieOptions, IEmailSender emailSender, ISmsSender smsSender, ILoggerFactory loggerFactory)</div><div class="ttdef"><b>Definition:</b> <a href="_account_controller_8cs_source.html#l00026">AccountController.cs:26</a></div></div>
<div class="ttc" id="class_gameblasts_1_1_models_1_1_account_view_models_1_1_send_code_view_model_html_acc7bfd167ef66d51bf151d8ef74036f6"><div class="ttname"><a href="class_gameblasts_1_1_models_1_1_account_view_models_1_1_send_code_view_model.html#acc7bfd167ef66d51bf151d8ef74036f6">Gameblasts.Models.AccountViewModels.SendCodeViewModel.ReturnUrl</a></div><div class="ttdeci">string ReturnUrl</div><div class="ttdef"><b>Definition:</b> <a href="_send_code_view_model_8cs_source.html#l00012">SendCodeViewModel.cs:12</a></div></div>
<div class="ttc" id="class_gameblasts_1_1_controllers_1_1_account_controller_html_a76a6fca1ff0dc35cf375b212c2d963ae"><div class="ttname"><a href="class_gameblasts_1_1_controllers_1_1_account_controller.html#a76a6fca1ff0dc35cf375b212c2d963ae">Gameblasts.Controllers.AccountController.ExternalLoginCallback</a></div><div class="ttdeci">async Task&lt; IActionResult &gt; ExternalLoginCallback(string returnUrl=null, string remoteError=null)</div><div class="ttdef"><b>Definition:</b> <a href="_account_controller_8cs_source.html#l00163">AccountController.cs:163</a></div></div>
<div class="ttc" id="class_gameblasts_1_1_models_1_1_account_view_models_1_1_login_view_model_html_a6556864bfd85b22eece6e13431ef23cb"><div class="ttname"><a href="class_gameblasts_1_1_models_1_1_account_view_models_1_1_login_view_model.html#a6556864bfd85b22eece6e13431ef23cb">Gameblasts.Models.AccountViewModels.LoginViewModel.RememberMe</a></div><div class="ttdeci">bool RememberMe</div><div class="ttdef"><b>Definition:</b> <a href="_login_view_model_8cs_source.html#l00015">LoginViewModel.cs:15</a></div></div>
<div class="ttc" id="namespace_gameblasts_html"><div class="ttname"><a href="namespace_gameblasts.html">Gameblasts</a></div></div>
<div class="ttc" id="class_gameblasts_1_1_models_1_1_account_view_models_1_1_register_view_model_html_af999ff9a75092c5dfe8293e1a4dc654e"><div class="ttname"><a href="class_gameblasts_1_1_models_1_1_account_view_models_1_1_register_view_model.html#af999ff9a75092c5dfe8293e1a4dc654e">Gameblasts.Models.AccountViewModels.RegisterViewModel.Email</a></div><div class="ttdeci">string Email</div><div class="ttdef"><b>Definition:</b> <a href="_register_view_model_8cs_source.html#l00014">RegisterViewModel.cs:14</a></div></div>
<div class="ttc" id="class_gameblasts_1_1_controllers_1_1_account_controller_html_a4704fe7c5fb45980c24154fda370450d"><div class="ttname"><a href="class_gameblasts_1_1_controllers_1_1_account_controller.html#a4704fe7c5fb45980c24154fda370450d">Gameblasts.Controllers.AccountController.SendCode</a></div><div class="ttdeci">async Task&lt; ActionResult &gt; SendCode(string returnUrl=null, bool rememberMe=false)</div><div class="ttdef"><b>Definition:</b> <a href="_account_controller_8cs_source.html#l00348">AccountController.cs:348</a></div></div>
<div class="ttc" id="class_gameblasts_1_1_controllers_1_1_account_controller_html_a81074857cc4837aee0ff83c47c2d665d"><div class="ttname"><a href="class_gameblasts_1_1_controllers_1_1_account_controller.html#a81074857cc4837aee0ff83c47c2d665d">Gameblasts.Controllers.AccountController.Register</a></div><div class="ttdeci">async Task&lt; IActionResult &gt; Register(RegisterViewModel model, string returnUrl=null)</div><div class="ttdef"><b>Definition:</b> <a href="_account_controller_8cs_source.html#l00108">AccountController.cs:108</a></div></div>
<div class="ttc" id="class_gameblasts_1_1_models_1_1_account_view_models_1_1_forgot_password_view_model_html"><div class="ttname"><a href="class_gameblasts_1_1_models_1_1_account_view_models_1_1_forgot_password_view_model.html">Gameblasts.Models.AccountViewModels.ForgotPasswordViewModel</a></div><div class="ttdef"><b>Definition:</b> <a href="_forgot_password_view_model_8cs_source.html#l00005">ForgotPasswordViewModel.cs:5</a></div></div>
<div class="ttc" id="class_gameblasts_1_1_controllers_1_1_account_controller_html_a982c56fe541631474ae054d49f67af0a"><div class="ttname"><a href="class_gameblasts_1_1_controllers_1_1_account_controller.html#a982c56fe541631474ae054d49f67af0a">Gameblasts.Controllers.AccountController.ConfirmEmail</a></div><div class="ttdeci">async Task&lt; IActionResult &gt; ConfirmEmail(string userId, string code)</div><div class="ttdef"><b>Definition:</b> <a href="_account_controller_8cs_source.html#l00238">AccountController.cs:238</a></div></div>
<div class="ttc" id="namespace_gameblasts_1_1_models_1_1_account_view_models_html"><div class="ttname"><a href="namespace_gameblasts_1_1_models_1_1_account_view_models.html">Gameblasts.Models.AccountViewModels</a></div><div class="ttdef"><b>Definition:</b> <a href="_external_login_confirmation_view_model_8cs_source.html#l00003">ExternalLoginConfirmationViewModel.cs:3</a></div></div>
<div class="ttc" id="class_gameblasts_1_1_controllers_1_1_account_controller_html_a0a323e76dde57001073b79763b038fdc"><div class="ttname"><a href="class_gameblasts_1_1_controllers_1_1_account_controller.html#a0a323e76dde57001073b79763b038fdc">Gameblasts.Controllers.AccountController.ForgotPassword</a></div><div class="ttdeci">IActionResult ForgotPassword()</div><div class="ttdef"><b>Definition:</b> <a href="_account_controller_8cs_source.html#l00257">AccountController.cs:257</a></div></div>
<div class="ttc" id="class_gameblasts_1_1_models_1_1_account_view_models_1_1_reset_password_view_model_html_a45ce253547809e63da2ac226e5784c65"><div class="ttname"><a href="class_gameblasts_1_1_models_1_1_account_view_models_1_1_reset_password_view_model.html#a45ce253547809e63da2ac226e5784c65">Gameblasts.Models.AccountViewModels.ResetPasswordViewModel.Code</a></div><div class="ttdeci">string Code</div><div class="ttdef"><b>Definition:</b> <a href="_reset_password_view_model_8cs_source.html#l00021">ResetPasswordViewModel.cs:21</a></div></div>
<div class="ttc" id="namespace_gameblasts_1_1_models_html"><div class="ttname"><a href="namespace_gameblasts_1_1_models.html">Gameblasts.Models</a></div></div>
<div class="ttc" id="class_gameblasts_1_1_models_1_1_account_view_models_1_1_send_code_view_model_html_a35f8744de18b302f8d7a37ae31ff9470"><div class="ttname"><a href="class_gameblasts_1_1_models_1_1_account_view_models_1_1_send_code_view_model.html#a35f8744de18b302f8d7a37ae31ff9470">Gameblasts.Models.AccountViewModels.SendCodeViewModel.RememberMe</a></div><div class="ttdeci">bool RememberMe</div><div class="ttdef"><b>Definition:</b> <a href="_send_code_view_model_8cs_source.html#l00014">SendCodeViewModel.cs:14</a></div></div>
<div class="ttc" id="class_gameblasts_1_1_models_1_1_account_view_models_1_1_verify_code_view_model_html"><div class="ttname"><a href="class_gameblasts_1_1_models_1_1_account_view_models_1_1_verify_code_view_model.html">Gameblasts.Models.AccountViewModels.VerifyCodeViewModel</a></div><div class="ttdef"><b>Definition:</b> <a href="_verify_code_view_model_8cs_source.html#l00005">VerifyCodeViewModel.cs:5</a></div></div>
<div class="ttc" id="class_gameblasts_1_1_controllers_1_1_account_controller_html_aafbb8e5973e59abd35e79ff00bea602b"><div class="ttname"><a href="class_gameblasts_1_1_controllers_1_1_account_controller.html#aafbb8e5973e59abd35e79ff00bea602b">Gameblasts.Controllers.AccountController.ForgotPassword</a></div><div class="ttdeci">async Task&lt; IActionResult &gt; ForgotPassword(ForgotPasswordViewModel model)</div><div class="ttdef"><b>Definition:</b> <a href="_account_controller_8cs_source.html#l00267">AccountController.cs:267</a></div></div>
<div class="ttc" id="class_gameblasts_1_1_models_1_1_account_view_models_1_1_verify_code_view_model_html_a59baa4f1101cd1a104d25ff882295456"><div class="ttname"><a href="class_gameblasts_1_1_models_1_1_account_view_models_1_1_verify_code_view_model.html#a59baa4f1101cd1a104d25ff882295456">Gameblasts.Models.AccountViewModels.VerifyCodeViewModel.Code</a></div><div class="ttdeci">string Code</div><div class="ttdef"><b>Definition:</b> <a href="_verify_code_view_model_8cs_source.html#l00011">VerifyCodeViewModel.cs:11</a></div></div>
<div class="ttc" id="class_gameblasts_1_1_models_1_1_account_view_models_1_1_login_view_model_html"><div class="ttname"><a href="class_gameblasts_1_1_models_1_1_account_view_models_1_1_login_view_model.html">Gameblasts.Models.AccountViewModels.LoginViewModel</a></div><div class="ttdef"><b>Definition:</b> <a href="_login_view_model_8cs_source.html#l00005">LoginViewModel.cs:5</a></div></div>
<div class="ttc" id="class_gameblasts_1_1_controllers_1_1_account_controller_html_ad583a58ae1caab8008bbdcad17ef6f2e"><div class="ttname"><a href="class_gameblasts_1_1_controllers_1_1_account_controller.html#ad583a58ae1caab8008bbdcad17ef6f2e">Gameblasts.Controllers.AccountController.VerifyCode</a></div><div class="ttdeci">async Task&lt; IActionResult &gt; VerifyCode(string provider, bool rememberMe, string returnUrl=null)</div><div class="ttdef"><b>Definition:</b> <a href="_account_controller_8cs_source.html#l00402">AccountController.cs:402</a></div></div>
<div class="ttc" id="class_gameblasts_1_1_controllers_1_1_account_controller_html_add1cc307820abd3a07bae2cba5f197c0"><div class="ttname"><a href="class_gameblasts_1_1_controllers_1_1_account_controller.html#add1cc307820abd3a07bae2cba5f197c0">Gameblasts.Controllers.AccountController.Login</a></div><div class="ttdeci">async Task&lt; IActionResult &gt; Login(LoginViewModel model, string returnUrl=null)</div><div class="ttdef"><b>Definition:</b> <a href="_account_controller_8cs_source.html#l00060">AccountController.cs:60</a></div></div>
<div class="ttc" id="class_gameblasts_1_1_controllers_1_1_account_controller_html_a4857c5119b609a03477f21119a1a944d"><div class="ttname"><a href="class_gameblasts_1_1_controllers_1_1_account_controller.html#a4857c5119b609a03477f21119a1a944d">Gameblasts.Controllers.AccountController.ExternalLogin</a></div><div class="ttdeci">IActionResult ExternalLogin(string provider, string returnUrl=null)</div><div class="ttdef"><b>Definition:</b> <a href="_account_controller_8cs_source.html#l00151">AccountController.cs:151</a></div></div>
<div class="ttc" id="class_gameblasts_1_1_models_1_1_account_view_models_1_1_reset_password_view_model_html_a488fad8cf73d37a483116f66b76261d3"><div class="ttname"><a href="class_gameblasts_1_1_models_1_1_account_view_models_1_1_reset_password_view_model.html#a488fad8cf73d37a483116f66b76261d3">Gameblasts.Models.AccountViewModels.ResetPasswordViewModel.Email</a></div><div class="ttdeci">string Email</div><div class="ttdef"><b>Definition:</b> <a href="_reset_password_view_model_8cs_source.html#l00009">ResetPasswordViewModel.cs:9</a></div></div>
<div class="ttc" id="class_gameblasts_1_1_controllers_1_1_account_controller_html_a01c414185b228bc65e2d7a3c0665a7a2"><div class="ttname"><a href="class_gameblasts_1_1_controllers_1_1_account_controller.html#a01c414185b228bc65e2d7a3c0665a7a2">Gameblasts.Controllers.AccountController.AccessDenied</a></div><div class="ttdeci">IActionResult AccessDenied()</div><div class="ttdef"><b>Definition:</b> <a href="_account_controller_8cs_source.html#l00448">AccountController.cs:448</a></div></div>
<div class="ttc" id="class_gameblasts_1_1_controllers_1_1_account_controller_html"><div class="ttname"><a href="class_gameblasts_1_1_controllers_1_1_account_controller.html">Gameblasts.Controllers.AccountController</a></div><div class="ttdef"><b>Definition:</b> <a href="_account_controller_8cs_source.html#l00017">AccountController.cs:17</a></div></div>
<div class="ttc" id="class_gameblasts_1_1_controllers_1_1_home_controller_html_a2a54191af0467749dfbe76af0fff4f57"><div class="ttname"><a href="class_gameblasts_1_1_controllers_1_1_home_controller.html#a2a54191af0467749dfbe76af0fff4f57">Gameblasts.Controllers.HomeController.Index</a></div><div class="ttdeci">IActionResult Index(int count)</div><div class="ttdef"><b>Definition:</b> <a href="_home_controller_8cs_source.html#l00025">HomeController.cs:25</a></div></div>
<div class="ttc" id="class_gameblasts_1_1_controllers_1_1_account_controller_html_aa294b6ba404633b45ff18bfb250ac138"><div class="ttname"><a href="class_gameblasts_1_1_controllers_1_1_account_controller.html#aa294b6ba404633b45ff18bfb250ac138">Gameblasts.Controllers.AccountController.ResetPasswordConfirmation</a></div><div class="ttdeci">IActionResult ResetPasswordConfirmation()</div><div class="ttdef"><b>Definition:</b> <a href="_account_controller_8cs_source.html#l00339">AccountController.cs:339</a></div></div>
<div class="ttc" id="class_gameblasts_1_1_models_1_1_account_view_models_1_1_external_login_confirmation_view_model_html"><div class="ttname"><a href="class_gameblasts_1_1_models_1_1_account_view_models_1_1_external_login_confirmation_view_model.html">Gameblasts.Models.AccountViewModels.ExternalLoginConfirmationViewModel</a></div><div class="ttdef"><b>Definition:</b> <a href="_external_login_confirmation_view_model_8cs_source.html#l00005">ExternalLoginConfirmationViewModel.cs:5</a></div></div>
<div class="ttc" id="class_gameblasts_1_1_controllers_1_1_account_controller_html_a8d1296221b26ccfc55c92306c953bd4c"><div class="ttname"><a href="class_gameblasts_1_1_controllers_1_1_account_controller.html#a8d1296221b26ccfc55c92306c953bd4c">Gameblasts.Controllers.AccountController.ResetPassword</a></div><div class="ttdeci">IActionResult ResetPassword(string code=null)</div><div class="ttdef"><b>Definition:</b> <a href="_account_controller_8cs_source.html#l00304">AccountController.cs:304</a></div></div>
<div class="ttc" id="interface_gameblasts_1_1_services_1_1_i_email_sender_html"><div class="ttname"><a href="interface_gameblasts_1_1_services_1_1_i_email_sender.html">Gameblasts.Services.IEmailSender</a></div><div class="ttdef"><b>Definition:</b> <a href="_i_email_sender_8cs_source.html#l00005">IEmailSender.cs:5</a></div></div>
<div class="ttc" id="class_gameblasts_1_1_controllers_1_1_account_controller_html_a258df15230ca9ae910243f8afe6068ff"><div class="ttname"><a href="class_gameblasts_1_1_controllers_1_1_account_controller.html#a258df15230ca9ae910243f8afe6068ff">Gameblasts.Controllers.AccountController.Login</a></div><div class="ttdeci">async Task&lt; IActionResult &gt; Login(string returnUrl=null)</div><div class="ttdef"><b>Definition:</b> <a href="_account_controller_8cs_source.html#l00046">AccountController.cs:46</a></div></div>
<div class="ttc" id="class_gameblasts_1_1_models_1_1_account_view_models_1_1_send_code_view_model_html"><div class="ttname"><a href="class_gameblasts_1_1_models_1_1_account_view_models_1_1_send_code_view_model.html">Gameblasts.Models.AccountViewModels.SendCodeViewModel</a></div><div class="ttdef"><b>Definition:</b> <a href="_send_code_view_model_8cs_source.html#l00006">SendCodeViewModel.cs:6</a></div></div>
<div class="ttc" id="class_gameblasts_1_1_controllers_1_1_account_controller_html_add184fcda15e5cf17e62460f1305b002"><div class="ttname"><a href="class_gameblasts_1_1_controllers_1_1_account_controller.html#add184fcda15e5cf17e62460f1305b002">Gameblasts.Controllers.AccountController.VerifyCode</a></div><div class="ttdeci">async Task&lt; IActionResult &gt; VerifyCode(VerifyCodeViewModel model)</div><div class="ttdef"><b>Definition:</b> <a href="_account_controller_8cs_source.html#l00418">AccountController.cs:418</a></div></div>
<div class="ttc" id="class_gameblasts_1_1_models_1_1_account_view_models_1_1_reset_password_view_model_html_a58cd70ea2e86a480dd57f0e15f17e4ec"><div class="ttname"><a href="class_gameblasts_1_1_models_1_1_account_view_models_1_1_reset_password_view_model.html#a58cd70ea2e86a480dd57f0e15f17e4ec">Gameblasts.Models.AccountViewModels.ResetPasswordViewModel.Password</a></div><div class="ttdeci">string Password</div><div class="ttdef"><b>Definition:</b> <a href="_reset_password_view_model_8cs_source.html#l00014">ResetPasswordViewModel.cs:14</a></div></div>
<div class="ttc" id="class_gameblasts_1_1_models_1_1_account_view_models_1_1_verify_code_view_model_html_ac38c932dcbdf4e49f8c849c8ddce4f37"><div class="ttname"><a href="class_gameblasts_1_1_models_1_1_account_view_models_1_1_verify_code_view_model.html#ac38c932dcbdf4e49f8c849c8ddce4f37">Gameblasts.Models.AccountViewModels.VerifyCodeViewModel.RememberBrowser</a></div><div class="ttdeci">bool RememberBrowser</div><div class="ttdef"><b>Definition:</b> <a href="_verify_code_view_model_8cs_source.html#l00016">VerifyCodeViewModel.cs:16</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_f1e231c396d6a78f925b250f39acb3ba.html">Controllers</a></li><li class="navelem"><a class="el" href="_account_controller_8cs.html">AccountController.cs</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
